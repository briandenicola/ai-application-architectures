version: '3'

dotenv: ['.env']

env:
  DEFAULT_TITLE: openai_learnings
  DEFAULT_REGION: "eastus2"

includes:
  di: ./infrastructure/document-intelligence/Taskfile.yaml
  basic: ./infrastructure/ai-foundry-basic/Taskfile.yaml
  standard: ./infrastructure/ai-foundry-standard/Taskfile.yaml

tasks:
  default: 
    cmds: 
    - task --list 
  
  jokester:
    desc: Tell me a Joke
    dir: ./src/jokester
    cmds:
    - dotnet run

  coin:
    desc: Analyze a Romain Coin
    dir: ./src/ric_analyzer
    cmds:
    - dotnet run

  otel:
    desc: Semantic Kernel with Observability
    dir: ./src/ric_analyzer_with_observability
    cmds:
    - docker run --rm -p 18888:18888 -p 4317:18889 -d --name aspire-dashboard  mcr.microsoft.com/dotnet/aspire-dashboard:8.1.0 > /dev/null 2>&1 || true
    - cmd: dotnet run
      silent: true
    - task: aspire-dashboard
  
  aspire-dashboard:
    desc: Gets Login Info for Aspire
    cmds:
    - cmd: echo Check Aspire Dashboard at {{.URL}} for more details
      silent: true
    vars:
      URL:
        sh: docker logs aspire-dashboard | grep -i "Login to the dashboard at" | awk '{print $6}' | sed 's/0\.0\.0\.0/localhost/'

  article:
    desc: Summarize a Podcast transcription
    dir: ./src/summarize_article
    cmds:
    - dotnet run